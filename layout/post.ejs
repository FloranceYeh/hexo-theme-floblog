<% 
    var showToc = page.toc !== false && toc(page.content).length > 0; 
%>

<% if (showToc) { %>
<link rel="stylesheet" href="/css/partials/toc.css">
<script src="/js/lib/toc.js"></script>
<% } %>
<link rel="stylesheet" href="/css/post.css">

<div class="post-main-wrapper <%= showToc ? 'has-toc' : 'no-toc' %>">
    <div class="article">
        <div>
            <h1><%= page.title %></h1>
        </div>
        <div class="info">
            <span class="date">
                <span class="icon">
                    <i class="fa-solid fa-calendar fa-fw"></i>
                </span>
                <%= date(page.date, "YYYY/M/D") %>
            </span>
            <% if (page.categories && page.categories.data.length !== 0) { %>
            <span class="category">
                <a href="<%- url_for(page.categories.data[0].path) %>">
                    <span class="icon">
                        <i class="fa-solid fa-bookmark fa-fw"></i>
                    </span>
                    <%= page.categories.data[0].name %>
                </a>
            </span>
            <% } %>
            <% if (page.tags && page.tags.data.length !== 0) { %>
            <span class="tags">
                <span class="icon">
                    <i class="fa-solid fa-tags fa-fw"></i>
                </span>
                <% let prev; %>
                <% page.tags.data.forEach((tag) => { %>
                <span class="tag">
                    <%
                        const colors = theme.tags_colors.filter((color) => color !== prev);
                        let id = Math.floor(Math.random() * colors.length);
                        prev = colors[id];
                    %>
                    <a href="<%- url_for(tag.path) %>" style="color: <%- colors[id] %>">
                        <%= tag.name %>
                    </a>
                </span>
                <% }); %>
            </span>
            <% } %>
        </div>
        <div class="content" v-pre>
            <%- page.content %>
        </div>
    </div>

    <% if (showToc) { %> <%- partial("_partials/toc") %> <% } %>
    
</div>